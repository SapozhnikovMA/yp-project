## Оптимизация энергопотребление при производстве стали.
![image](https://www.rocta.ru/images/images_article/legirovannaya-stal-chto-ehto-takoe-marki-sostav-vidy-i-primenenie_9.png)

## 
- data_arc.csv — данные об электродах;
- data_bulk.csv — данные о подаче сыпучих материалов (объём);
- data_bulk_time.csv— данные о подаче сыпучих материалов (время);
- data_gas.csv — данные о продувке сплава газом;
- data_temp.csv — результаты измерения температуры;
- data_wire.csv — данные о проволочных материалах (объём);
- data_wire_time.csv — данные о проволочных материалах (время).

## План работы:
  - Создание новых фичей для анализа данных и предсказаний, соединение нескольких источников в один;
  - Исследовательскийй анализ данных - он помогает лучше понять данные и взаимосвязи;
  - Проверка на мультиколлинеарность;
  - Выделение важности признаков при обучении моделей, для собственного понимания процесса и объяснения Заказчикам;

## Стек технологий: pandas, numpy, matplotlib, sklearn (LinearRegression, DecisionTreeRegressor, RandomForestRegressor, GradientBoostingRegressor, RandomizedSearchCV, catboost, lightgbm.

## Описание шагов:
1. Предобработка датасетов и соедининеие их в единый датасет.
## Итоговый датасет
```
key	Температура_1	Температура_2	Активная мощность	Реактивная мощность	Газ 1	Bulk 1	Bulk 2	Bulk 3	Bulk 4	Bulk 5	Bulk 6	Bulk 7	Bulk 8	Bulk 9	Bulk 10	Bulk 11	Bulk 12	Bulk 13	Bulk 14	Bulk 15	Wire 1	Wire 2	Wire 3	Wire 4	Wire 5	Wire 6	Wire 7	Wire 8	Wire 9
0	1	1571.0	1613.0	4.878147	3.183241	29.749986	0.0	0.0	0.0	43.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	206.0	0.0	150.0	154.0	60.059998	0.00000	0.0	0.0	0.0	0.0	0.0	0.0	0.0
1	2	1581.0	1602.0	3.052598	1.998112	12.555561	0.0	0.0	0.0	73.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	206.0	0.0	149.0	154.0	96.052315	0.00000	0.0	0.0	0.0	0.0	0.0	0.0	0.0
2	3	1596.0	1599.0	2.525882	1.599076	28.554793	0.0	0.0	0.0	34.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	205.0	0.0	152.0	153.0	91.160157	0.00000	0.0	0.0	0.0	0.0	0.0	0.0	0.0
3	4	1601.0	1625.0	3.209250	2.060298	18.841219	0.0	0.0	0.0	81.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	207.0	0.0	153.0	154.0	89.063515	0.00000	0.0	0.0	0.0	0.0	0.0	0.0	0.0
4	5	1576.0	1602.0	3.347173	2.252643	5.413692	0.0	0.0	0.0	78.0	0.0	0.0	0.0	0.0	0.0	0.0	0.0	203.0	0.0	151.0	152.0	89.238236	9.11456	0.0	0.0	0.0	0.0	0.0	0.0	0.0
```

## Статистика
```
	key	Температура_1	Температура_2	Активная мощность	Реактивная мощность	Газ 1	Bulk 1	Bulk 2	Bulk 3	Bulk 4	Bulk 5	Bulk 6	Bulk 7	Bulk 8	Bulk 9	Bulk 10	Bulk 11	Bulk 12	Bulk 13	Bulk 14	Bulk 15	Wire 1	Wire 2	Wire 3	Wire 4	Wire 5	Wire 6	Wire 7	Wire 8	Wire 9
count	2433.000000	2433.000000	2433.000000	2433.000000	2433.000000	2431.000000	2365.000000	2365.000000	2365.000000	2365.000000	2365.000000	2365.000000	2365.000000	2365.000000	2365.000000	2365.000000	2365.000000	2365.000000	2365.000000	2365.000000	2365.000000	2336.000000	2336.000000	2336.000000	2336.000000	2336.0	2336.000000	2336.000000	2336.000000	2336.000000
mean	1249.351418	1588.297164	1595.351007	3.135468	2.335211	11.167258	3.333192	1.400846	46.443552	36.157717	2.600000	22.102326	1.994080	0.020719	0.438055	4.928964	4.021564	209.298097	1.051163	153.945032	117.133192	102.254943	17.959348	3.225099	0.305631	0.0	0.975887	0.006341	0.310378	0.420704
std	720.624129	29.405333	16.017495	1.428826	1.080565	6.335885	12.249339	18.937067	74.901107	58.196921	22.233414	55.543908	30.456801	1.007582	6.173334	20.652533	21.928374	156.386729	14.126855	82.070501	85.649739	43.742520	34.117002	27.901529	4.750638	0.0	8.680424	0.205397	4.396136	4.364634
min	1.000000	1191.000000	1541.000000	0.186226	0.158247	0.008399	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.0	0.000000	0.000000	0.000000	0.000000
25%	626.000000	1571.000000	1587.000000	2.155224	1.618716	7.125996	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	105.000000	0.000000	105.000000	0.000000	72.859018	0.000000	0.000000	0.000000	0.0	0.000000	0.000000	0.000000	0.000000
50%	1250.000000	1587.000000	1593.000000	3.022744	2.231670	9.942109	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	206.000000	0.000000	149.000000	106.000000	101.041199	0.000000	0.000000	0.000000	0.0	0.000000	0.000000	0.000000	0.000000
75%	1871.000000	1605.000000	1599.000000	3.920676	2.914965	13.879786	0.000000	0.000000	77.000000	75.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	0.000000	282.000000	0.000000	204.000000	204.000000	128.138394	23.170420	0.000000	0.000000	0.0	0.000000	0.000000	0.000000	0.000000
max	2499.000000	1679.000000	1700.000000	17.496497	12.587990	77.995040	185.000000	325.000000	454.000000	281.000000	603.000000	503.000000	772.000000	49.000000	147.000000	159.000000	313.000000	1849.000000	305.000000	636.000000	405.000000	330.314424	282.780152	385.008668	113.231044	0.0	180.454575	8.490040	102.762401	90.053604
```
### Мультиколлинеарность
  - Активная мощность и реактивная мощность имеют корреляцию больше 0,7 (мультиколлинеарность). Для исключения нагрузки на модели уберем избыточную фичу, либо правильным будет получить полную мощность - S = sqrt(P^2 + Q^2).
  - Bulk 9 and Wire 8 - мультиколлинеартны (0.97) - удаляем признак Wire 8, т.к. меньше наблюдений;
  - Bulk 2, Bulk 7 сильно коррелирует с Wire 4 - 0,7 и 0,74 - удалим Wire 4, т.к. связь с большим кол-вом элементов;
  - Удалим Wire 5, т.к. трайб мало использовался в производстве.

### Целевой признак Т_2 - конечная температура, цель MAE < 6.

### Обучение моделей
```
	Параметры	Const_model	LinReg	RFR	RFR_m	catboost	catboost_m	lgbm	lgbm_m
0	cross_val_score, MAE	10.11	8.03	6.70	6.69	6.20	6.28	6.85	6.68
1	best_score_test, MAE	NaN	NaN	NaN	5.94	5.75	5.99	6.08	6.04
2	time_fit, сек	NaN	0.18	2.82	4.03	58.00	16.30	14.39	10.50
```
- Важные признаки - Т_1, Полная мощность, Wire 1;
- Лучшее качество удалось достичь на модели catboost из коробки, но время обучение самое большое, хотя его можно сократить с помощью early_stopping;
- Модель случайного леса с изменением одного параметра (глубины дерева) тоже дала высокие резльтаты на тесте;
- Модель линейной регресии использовала всего два параметра, поэтому качество ниже;
- В итоге удалось значительно превзойти константную модель.







